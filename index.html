<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>ğŸ’— å«æ˜Ÿç¯ç»• Â· æƒ…ä¾£çºªå¿µ ğŸ’—</title>
    <!-- ä½¿ç”¨ Marked è§£æ Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #fff9fc;
            font-family: 'Segoe UI', 'Helvetica Neue', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
        }

        .frame {
            width: 100%;
            max-width: 380px;
            aspect-ratio: 9 / 16;
            background: rgba(255, 245, 248, 0.6);
            backdrop-filter: blur(2px);
            border-radius: 48px 48px 32px 32px;
            box-shadow: 0 20px 40px rgba(245, 150, 180, 0.15),
                        0 0 0 2px #ffe2eb inset;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
        }

        /* ä¸­å¤®å›¾ç‰‡å®¹å™¨ */
        .center-image-wrapper {
            width: 30%;
            aspect-ratio: 1 / 1;
            position: relative;
            z-index: 20;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 15px 25px #ffb6c190, 0 0 0 4px #ffe4ed;
            transition: all 0.1s ease;
        }

        .center-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: inherit;
            background: #ffd9e5;
        }

        /* è½¨é“å®¹å™¨ - ä¸å†æ•´ä½“æ—‹è½¬ */
        .orbit-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 30;
        }

        /* æ°”æ³¡åŸºç¡€æ ·å¼ */
        .bubble {
            position: absolute;
            width: 120px;
            max-width: 30vw;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            background: #fff0f5;
            border: 2px solid #ffb3c6;
            border-radius: 32px 32px 32px 8px;
            padding: 12px 14px;
            box-shadow: 0 10px 20px #ffa5b9a0, 0 4px 0 0 #fcc4d2 inset;
            color: #a93f5c;
            font-size: 14px;
            line-height: 1.5;
            word-break: break-word;
            pointer-events: auto;
            transition: transform 0.2s ease, filter 0.3s;
            transform-origin: center;
            left: 50%;
            top: 50%;
            opacity: 0;
            animation: bubble-fadein 0.4s forwards;
            z-index: 1;
        }

        /* æ·¡å…¥åŠ¨ç”» */
        @keyframes bubble-fadein {
            0% { opacity: 0; transform: scale(0.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* é®æŒ¡å…³ç³»ç±» */
        .bubble.behind {
            z-index: 5;  /* åœ¨ç…§ç‰‡åé¢ */
        }

        .bubble.front {
            z-index: 35; /* åœ¨ç…§ç‰‡å‰é¢ */
        }

        /* æ°”æ³¡å†…çš„ markdown æ ·å¼ */
        .bubble h1, .bubble h2, .bubble h3 {
            font-size: 1.3em;
            color: #c34f6a;
            margin: 4px 0;
        }
        .bubble p {
            margin: 4px 0;
        }
        .bubble em {
            color: #d66b81;
        }
        .bubble strong {
            color: #b3405c;
        }
        .bubble a {
            color: #b33f5c;
            text-decoration: underline wavy #ffb0c0 1px;
        }

        /* å…¨å±ç¼©å°åŠ¨ç”»ç›¸å…³ */
        .center-image-wrapper.initial-full {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            z-index: 100;
            box-shadow: none;
            transition: all 1.2s cubic-bezier(0.34, 1.2, 0.55, 1);
        }

        .center-image-wrapper.initial-full .center-image {
            border-radius: 0;
        }

        .center-image-wrapper.final-state {
            position: relative;
            width: 30%;
            top: auto;
            left: auto;
            border-radius: 30px;
            box-shadow: 0 15px 25px #ffb6c190, 0 0 0 4px #ffe4ed;
            transition: all 1.2s cubic-bezier(0.34, 1.2, 0.55, 1);
        }

        /* è£…é¥°å…ƒç´  */
        .decoration-dot {
            position: absolute;
            bottom: 12px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #ffc1d0, #ffd9e4);
            border-radius: 50%;
            opacity: 0.5;
            z-index: 5;
        }
        .decoration-heart {
            position: absolute;
            top: 16px;
            left: 16px;
            font-size: 24px;
            filter: drop-shadow(0 4px 6px #fbb6c6);
            z-index: 6;
            opacity: 0.7;
        }
        .loading-tip {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            text-align: center;
            color: #cc8195;
            font-size: 15px;
            letter-spacing: 1px;
            z-index: 10;
            background: linear-gradient(90deg, transparent, #ffe3ec, transparent);
            padding: 8px;
        }

        .markdown-content {
            user-select: text;
        }
    </style>
</head>
<body>
    <div class="frame">
        <div class="decoration-heart">ğŸ’—ğŸŒ¸ğŸ’—</div>
        <div class="decoration-dot"></div>

        <!-- å›¾ç‰‡AåŒ…è£…ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ -->
        <div id="imageWrapper" class="center-image-wrapper initial-full">
            <img src="picture/MainPic.jpeg" alt="æƒ…ä¾£çºªå¿µæ’å›¾" class="center-image" id="mainImage">
        </div>

        <!-- æ—‹è½¬å®¹å™¨ (æ°”æ³¡å°†åŠ¨æ€æ·»åŠ è‡³æ­¤) -->
        <div class="orbit-container" id="orbitContainer"></div>

        <div class="loading-tip" id="statusTip">ğŸ’• åŠ è½½æµªæ¼«è¯­å½•ä¸­... ğŸ’•</div>
    </div>

    <script>
        (function() {
            // ---------- 1. æ•°æ®åŠ è½½æ¨¡å— ----------
            let messageLibrary = [];
            let dataLoaded = false;
            
            // åŠ è½½å¤–éƒ¨ JSON æ–‡ä»¶
            async function loadMessagesFromJSON() {
                try {
                    const response = await fetch('messages.json');
                    if (!response.ok) throw new Error('ç½‘ç»œå“åº”å¤±è´¥');
                    const data = await response.json();
                    messageLibrary = data.messages; // å‡è®¾ JSON ç»“æ„ä¸º { messages: [...] }
                    dataLoaded = true;
                    console.log('æˆåŠŸåŠ è½½', messageLibrary.length, 'æ¡æ¶ˆæ¯');
                } catch (error) {
                    console.error('åŠ è½½ JSON å¤±è´¥ï¼Œä½¿ç”¨å†…ç½®å¤‡ç”¨æ•°æ®', error);
                    // å¤‡ç”¨æ•°æ®
                    messageLibrary = [
                        "**ğŸ’ æ¯ä¸€å¤©**\néƒ½æ˜¯çºªå¿µæ—¥ * forever *",
                        "## ğŸ° çºªå¿µæ—¥å¿«ä¹\n> å’Œä½ ä¸€èµ·  **æœæœæš®æš®**",
                        "âœ¨ ä½ æ˜¯æˆ‘\n```\nå®‡å®™ä¸­æœ€æ¸©æŸ”\nçš„é‚£é¢—æ˜Ÿ```",
                        "### ğŸ’Œ å†™äºæ˜¥å¤©\næˆ‘æƒ³ *ç´§ç´§* æ‹¥æŠ±ä½   â€”  **æ°¸è¿œ**",
                        "![â¤ï¸](https://via.placeholder.com/20/ff99bb/000000?text=â¤ï¸)  *ç›¸é‡*  **å³æ°¸æ’**",
                        "## ğŸŒ¸ 2025 Â· å¤\nå¾®é£å’Œä½ éƒ½ **ç‰¹åˆ«ç”œ**",
                        "> æµ·åº•æœˆæ˜¯å¤©ä¸Šæœˆ\nâ€”â€” **çœ¼å‰äººæ˜¯å¿ƒä¸Šäºº**",
                        "**365å¤©**\n+ æ¯ä¸€å¤©éƒ½åƒåˆæ‹",
                        "## ğŸ’˜ å‘½ä¸­æ³¨å®š\n> ä½ åœ¨å“ªé‡Œï¼Œå®¶å°±åœ¨å“ªé‡Œ",
                        "### âœ¨ æ—‹è½¬æœ¨é©¬\næˆ‘ä»¬çš„çˆ±  *æ°¸ä¸è½å¹•*"
                    ];
                    dataLoaded = true;
                }
            }

            // è·å–éšæœºäº”æ¡æ¶ˆæ¯
            function getRandomFive() {
                if (!dataLoaded || messageLibrary.length === 0) {
                    console.warn('æ¶ˆæ¯åº“æœªå°±ç»ªï¼Œä½¿ç”¨é»˜è®¤æ¶ˆæ¯');
                    return ["ğŸ’• åŠ è½½ä¸­...", "ğŸ’• è¯·ç¨å€™", "ğŸ’• å³å°†å‡ºç°", "ğŸ’• çˆ±çš„å¯„è¯­", "ğŸ’• çºªå¿µæ—¥å¿«ä¹"];
                }
                const shuffled = [...messageLibrary].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, 5);
            }

            // ---------- 2. å›¾ç‰‡é”™è¯¯å¤„ç† ----------
            document.getElementById('mainImage').onerror = function() {
                console.warn('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥è·¯å¾„ picture/MainPic.jpeg');
                this.src = 'data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22400%22%20height%3D%22400%22%20viewBox%3D%220%200%20400%20400%22%3E%3Crect%20width%3D%22400%22%20height%3D%22400%22%20fill%3D%22%23ffd9e5%22%2F%3E%3Ctext%20x%3D%2250%25%22%20y%3D%2250%25%22%20dominant-baseline%3D%22middle%22%20text-anchor%3D%22middle%22%20fill%3D%22%23b3405c%22%20font-size%3D%2220%22%3EğŸ’—%20çºªå¿µæ—¥%20ğŸ’—%3C%2Ftext%3E%3C%2Fsvg%3E';
            };

            // ---------- 3. è·å–DOMå…ƒç´  ----------
            const wrapper = document.getElementById('imageWrapper');
            const orbit = document.getElementById('orbitContainer');
            const tip = document.getElementById('statusTip');

            // ç¡®ä¿åˆå§‹æ˜¯å…¨å±æ¨¡å¼
            wrapper.classList.remove('final-state');
            wrapper.classList.add('initial-full');

            // ---------- 4. æ¤­åœ†è½¨é“å®šä½å‡½æ•° ----------
            function repositionBubbles() {
                const frame = document.querySelector('.frame');
                if (!frame) return;
                
                const frameRect = frame.getBoundingClientRect();
                const centerX = frameRect.width / 2;
                const centerY = frameRect.height / 2;
                
                // æ¤­åœ†è½¨é“å‚æ•°ï¼šæ°´å¹³åŠå¾„è¾ƒå¤§ï¼Œå‚ç›´åŠå¾„è¾ƒå°
                const radiusX = frameRect.width * 0.4;  // æ°´å¹³è½´
                const radiusY = frameRect.height * 0.2; // å‚ç›´è½´
                
                const bubbles = document.querySelectorAll('.bubble');
                const angleStep = (2 * Math.PI) / bubbles.length;
                
                // ä½¿ç”¨æ—¶é—´æ§åˆ¶æ—‹è½¬é€Ÿåº¦ (æ¯ 20 ç§’ä¸€åœˆ)
                const startAngle = (performance.now() / 20000) * 2 * Math.PI;
                
                bubbles.forEach((bubble, idx) => {
                    const angle = startAngle + idx * angleStep;
                    
                    // æ¤­åœ†è½¨è¿¹ä¸Šçš„åæ ‡
                    const bubbleCenterX = centerX + radiusX * Math.cos(angle);
                    const bubbleCenterY = centerY + radiusY * Math.sin(angle);
                    
                    // è·å–æ°”æ³¡å®½é«˜
                    const w = bubble.offsetWidth;
                    const h = bubble.offsetHeight;
                    
                    if (w === 0 || h === 0) {
                        bubble.style.left = (bubbleCenterX - 60) + 'px';
                        bubble.style.top = (bubbleCenterY - 40) + 'px';
                    } else {
                        bubble.style.left = (bubbleCenterX - w/2) + 'px';
                        bubble.style.top = (bubbleCenterY - h/2) + 'px';
                    }
                    
                    // æ ¹æ® Y åæ ‡åˆ¤æ–­å‰åé®æŒ¡å…³ç³»
                    // å½“æ°”æ³¡åœ¨æ¤­åœ†ä¸‹åŠéƒ¨åˆ† (sin(angle) > 0) æ—¶åœ¨å‰ï¼Œä¸ŠåŠéƒ¨åˆ†åœ¨å
                    if (Math.sin(angle) > 0) {
                        bubble.classList.add('front');
                        bubble.classList.remove('behind');
                    } else {
                        bubble.classList.add('behind');
                        bubble.classList.remove('front');
                    }
                });
            }

            // ---------- 5. åŠ¨ç”»å¾ªç¯ ----------
            let animationFrame;
            function startOrbitAnimation() {
                function animate() {
                    repositionBubbles();
                    animationFrame = requestAnimationFrame(animate);
                }
                animationFrame = requestAnimationFrame(animate);
            }

            // ---------- 6. åˆå§‹åŒ–æ°”æ³¡ (ç­‰å¾…æ•°æ®åŠ è½½å) ----------
            const loadPromise = loadMessagesFromJSON();
            
            async function initializeBubbles() {
                await loadPromise; // ç­‰å¾… JSON åŠ è½½å®Œæˆ
                
                const randomTexts = getRandomFive();
                
                // æ¸…ç©º orbit
                orbit.innerHTML = '';
                
                // åˆ›å»ºäº”ä¸ªæ°”æ³¡
                for (let i = 0; i < 5; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    
                    const rawMarkdown = randomTexts[i] || "ğŸ’• çºªå¿µæ—¥å¿«ä¹";
                    
                    let htmlContent = '';
                    try {
                        htmlContent = marked.parse(rawMarkdown);
                    } catch (e) {
                        htmlContent = `<p>${rawMarkdown}</p>`;
                    }
                    bubble.innerHTML = `<div class="markdown-content">${htmlContent}</div>`;
                    orbit.appendChild(bubble);
                }
                
                // åˆå§‹å®šä½
                repositionBubbles();
                
                // å¯åŠ¨åŠ¨ç”»å¾ªç¯
                startOrbitAnimation();
            }

            // æ‰§è¡Œåˆå§‹åŒ–
            initializeBubbles();

            // ---------- 7. çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°è®¡ç®—ä½ç½® ----------
            window.addEventListener('resize', () => {
                repositionBubbles();
            });

            // ---------- 8. æ¸…ç†åŠ¨ç”» ----------
            window.addEventListener('beforeunload', function() {
                if (animationFrame) {
                    cancelAnimationFrame(animationFrame);
                }
            });

            // ---------- 9. ç¼©å°åŠ¨ç”» ----------
            setTimeout(() => {
                wrapper.classList.remove('initial-full');
                wrapper.classList.add('final-state');
                tip.innerText = 'ğŸ’– å«æ˜Ÿç¯ç»• Â· çˆ±æ„æ°¸æ’ ğŸ’–';
                tip.style.opacity = '0.8';
            }, 800);
        })();
    </script>

    <!-- ========== éƒ¨ç½²è¯´æ˜ ========== -->
    <!-- 
        æ–‡ä»¶ç»“æ„è¦æ±‚ï¼š
        â”œâ”€â”€ index.html          (æœ¬æ–‡ä»¶)
        â”œâ”€â”€ messages.json        (å¤–éƒ¨æ–‡æœ¬åº“ï¼Œæ ¼å¼è§ä¸‹)
        â””â”€â”€ picture/
            â””â”€â”€ MainPic.jpeg     (çºªå¿µå›¾ç‰‡ï¼Œæ­£æ–¹å½¢æ¨è)

        messages.json æ ¼å¼ç¤ºä¾‹ï¼š
        {
            "messages": [
                "**ğŸ’ ç¬¬ä¸€æ¡æ¶ˆæ¯**\nå†…å®¹æ”¯æŒ *Markdown*",
                "## ç¬¬äºŒæ¡æ¶ˆæ¯",
                "> ç¬¬ä¸‰æ¡æ¶ˆæ¯"
            ]
        }

        GitHub Pages éƒ¨ç½²æ­¥éª¤ï¼š
        1. åœ¨ GitHub æ–°å»ºä»“åº“ï¼ˆå¦‚ love-orbitï¼‰
        2. ä¸Šä¼ ä»¥ä¸Šä¸‰ä¸ªæ–‡ä»¶/æ–‡ä»¶å¤¹åˆ°ä»“åº“æ ¹ç›®å½•
        3. ä»“åº“ Settings -> Pages -> é€‰æ‹© main åˆ†æ”¯ï¼Œæ ¹ç›®å½•ï¼Œä¿å­˜
        4. ç­‰å¾…å‡ åˆ†é’Ÿï¼Œè®¿é—® https://<ç”¨æˆ·å>.github.io/<ä»“åº“å>/
    -->
</body>
</html>
